(this["webpackJsonpctr-ocr"]=this["webpackJsonpctr-ocr"]||[]).push([[0],{140:function(e,t,n){e.exports=n(376)},145:function(e,t,n){},146:function(e,t,n){},184:function(e,t){},186:function(e,t){},213:function(e,t){},376:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),i=n(134),o=n.n(i),c=(n(145),n(31)),s=n(46),g=n(8),u=n.n(g),l=n(45),d=(n(146),n(72)),m=n(9),h=n(137),p=n.n(h),f=n(138),b=n.n(f),x=n(139),v=n.n(x),w=function(e,t){var n=1/0,r=e;return t.forEach((function(t){var a=v.a.get(e,t);a<n&&(n=a,r=t)})),r},_=function(e,t){for(var n=[],r=e;r<=t;r+=1)n.push(r);return n},j=function(e,t){return Math.round(e*t)},k=function(e,t){for(var n=e.charCodeAt(0),r=t.charCodeAt(0),a=[],i=n;i<=r;i+=1)a.push(String.fromCharCode(i));return a},y=k("A","Z").join(""),E=k("a","z").join(""),O="".concat(E).concat(y),L=_(0,9).join(""),S=_(1,8).join(""),z="".concat(L,":-"),C="".concat(O).concat(L,":-_."),I=["caso-pyro01","stin_wz","ZouGui28","francois24540","DGregson97","nessanumen","AlexKenshin_33","CrazyLittleJazzy","mmartin_m","Dr N. Tropy","Kity_Panda","Jakubeq1_","Assistant de laboratoire","B\xe9b\xe9 N. Tropy","Faux Crash","giomastik","MarioAlfie123","kimmyy043","Mav15151515","Axe34070","Stew"],W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=e.width,a=e.height,i=j(.64,r),o=j(.265,a),c=j(.27,r),s=j(.425,a),g=.73,u=.03,l=.27,d=.1,m=1-g-u,h={top:j(t/8,s),height:j(1/8,s)},p=o+h.top,f=h.height,b=i+j(g,c),x=j(m,c),v=i+j(l,c),w=j(1-m-l-u,c);if("position"===n){var _={left:i,top:p,width:j(d,c),height:f};return _}var k="time"===n,y=k?b:v,E=k?x:w,O={left:y,top:p,width:E,height:f};return O},P=function(){var e=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(!0),x(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r,a,i,c,g,d,h,f,v,j,y,E,O,P,A,B,J,R,G,M,N,T,D,K,Z;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:return x(!0),t=Object(m.createScheduler)(),n=Object(m.createScheduler)(),r=Object(m.createScheduler)(),a=Object(m.createWorker)({logger:function(e){return console.log(e)}}),i=Object(m.createWorker)({logger:function(e){return console.log(e)}}),c=Object(m.createWorker)({logger:function(e){return console.log(e)}}),g=Object(m.createWorker)({logger:function(e){return console.log(e)}}),d=Object(m.createWorker)({logger:function(e){return console.log(e)}}),h=Object(m.createWorker)({logger:function(e){return console.log(e)}}),t.addWorker(a),t.addWorker(i),n.addWorker(c),n.addWorker(g),r.addWorker(d),r.addWorker(h),(f=document.getElementById("img-show"))&&(f.innerHTML=""),o("Loading engines"),o("Loading engine 1"),e.next=24,a.load();case 24:return o("Loading engine 2"),e.next=27,i.load();case 27:return o("Loading engine 3"),e.next=30,c.load();case 30:return o("Loading engine 4"),e.next=33,g.load();case 33:return o("Loading engine 5"),e.next=36,d.load();case 36:return o("Loading engine 6"),e.next=39,h.load();case 39:return o("Loading languages"),o("Loading language 1"),e.next=43,a.loadLanguage("eng");case 43:return o("Loading language 2"),e.next=46,i.loadLanguage("eng");case 46:return o("Loading language 3"),e.next=49,c.loadLanguage("eng");case 49:return o("Loading language 4"),e.next=52,g.loadLanguage("eng");case 52:return o("Loading language 5"),e.next=55,d.loadLanguage("eng");case 55:return o("Loading language 6"),e.next=58,h.loadLanguage("eng");case 58:return o("Initializing engines"),o("Initializing engine 1"),e.next=62,a.initialize("eng");case 62:return o("Initializing engine 2"),e.next=65,i.initialize("eng");case 65:return o("Initializing engine 3"),e.next=68,c.initialize("eng");case 68:return o("Initializing engine 4"),e.next=71,g.initialize("eng");case 71:return o("Initializing engine 5"),e.next=74,d.initialize("eng");case 74:return o("Initializing engine 6"),e.next=77,h.initialize("eng");case 77:return o("Setting parameters"),o("Setting parameter 1"),e.next=81,a.setParameters({tessedit_char_whitelist:z,tessedit_pageseg_mode:"7"});case 81:return o("Setting parameter 2"),e.next=84,i.setParameters({tessedit_char_whitelist:z,tessedit_pageseg_mode:"7"});case 84:return o("Setting parameter 3"),e.next=87,c.setParameters({tessedit_char_whitelist:C,tessedit_pageseg_mode:"7"});case 87:return o("Setting parameter 4"),e.next=90,g.setParameters({tessedit_char_whitelist:C,tessedit_pageseg_mode:"7"});case 90:return o("Setting parameter 5"),e.next=93,d.setParameters({tessedit_char_whitelist:S,tessedit_pageseg_mode:"7"});case 93:return o("Setting parameter 6"),e.next=96,h.setParameters({tessedit_char_whitelist:S,tessedit_pageseg_mode:"7"});case 96:return v=_(0,7),j=function(){var e=Object(l.a)(u.a.mark((function e(a,i,o,c){var s,g,l,d,m,h,f,b,x,v;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=E.clone(),g=null,g="time"===i?t:"pseudo"===i?n:r,l=W(o,a,i),d=s.crop(l.left,l.top,l.width,l.height),m={count:2,type:"image/jpeg"},e.next=8,d.getBufferAsync("image/jpeg");case 8:return h=e.sent,e.next=11,p()(h,m).then((function(e){return console.log("\ud83d\ude80 ~ rgb ~ colors",a,e),[e[0].rgb(),e[1].rgb()]}));case 11:return f=e.sent,b=f[0][0]<f[1][0]&&f[0][1]<f[1][1]&&f[0][2]<f[1][2],(x=b?d.invert():d).getBase64("image/jpeg",(function(e,t){var n=document.createElement("img");n.setAttribute("src",t);var r=document.getElementById("img-show");r&&r.appendChild(n)})),e.next=17,x.getBufferAsync("image/jpeg");case 17:return v=e.sent,e.abrupt("return",g.addJob("recognize",v));case 19:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),y="https://raw.githubusercontent.com/sebranly/ctr-ocr/main/src/img/input/IMG".concat(L,".JPG"),o("Reading the image"),e.prev=100,e.next=103,b.a.read(y);case 103:return O=e.sent,o("Rotating the image"),(E=O.rotate(-6.2).grayscale()).getBase64("image/jpeg",(function(e,t){var n=document.createElement("img");n.setAttribute("src",t);var r=document.getElementById("img-show");r&&r.appendChild(n)})),P=E.bitmap.width,A=E.bitmap.height,B={width:P,height:A},console.log("info.width",B.width,"info.height",B.height),J=v.map((function(e){return j(e,"position",B,E)})),R=v.map((function(e){return j(e,"pseudo",B,E)})),G=v.map((function(e){return j(e,"time",B,E)})),o("Starting text recognition"),e.next=117,Promise.all([].concat(Object(s.a)(J),Object(s.a)(R),Object(s.a)(G)));case 117:return M=e.sent,N=M.map((function(e){return e.data.text.replace(/\n/g,"").replace(/ /g,"")})),T=N.slice(0,8),console.log("\ud83d\ude80 ~ file: App.tsx ~ line 269 ~ doOCR ~ resultsPositions",T),D=N.slice(8,16),K=N.slice(16),Z=[],v.forEach((function(e){var t=D[e],n={g:t,position:T[e],player:w(t,I),time:K[e]};Z.push(n)})),o(JSON.stringify(Z)),x(!1),e.next=129,t.terminate();case 129:return e.next=131,n.terminate();case 131:return e.next=133,r.terminate();case 133:e.next=139;break;case 135:e.prev=135,e.t0=e.catch(100),o("Unable to open image ".concat(e.t0.toString(),". Please restart.")),x(!1);case 139:case"end":return e.stop()}}),e,null,[[100,135]])})));return function(){return e.apply(this,arguments)}}(),n=r.useState("Pick an image"),a=Object(c.a)(n,2),i=a[0],o=a[1],g=r.useState(!0),h=Object(c.a)(g,2),f=h[0],x=h[1],v=r.useState(!1),j=Object(c.a)(v,2),k=j[0],y=j[1],E=r.useState(1),O=Object(c.a)(E,2),L=O[0],P=O[1];r.useEffect((function(){t()}),[L]),r.useEffect((function(){e()}),[]);var A="https://raw.githubusercontent.com/sebranly/ctr-ocr/main/src/img/input/IMG".concat(L,".JPG"),B=_(1,5);return r.createElement(d.b,null,r.createElement(d.a,null,r.createElement("title",null,"CTR OCR"),r.createElement("link",{rel:"canonical",href:"https://sebranly.github.io/ctr-ocr"})),r.createElement("div",{className:"main"},r.createElement("h1",{className:"white"},"CTR OCR"),r.createElement("select",{disabled:f,onChange:function(e){P(Number(e.target.value))}},B.map((function(e){return r.createElement("option",{key:e,label:e.toString(),value:e},"Image ",e)}))),r.createElement("img",{alt:"Example ".concat(L),src:A}),r.createElement("div",null,i),r.createElement("div",{id:"img-show"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[140,1,2]]]);
//# sourceMappingURL=main.e97c4735.chunk.js.map