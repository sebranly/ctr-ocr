(this["webpackJsonpctr-ocr"]=this["webpackJsonpctr-ocr"]||[]).push([[0],{140:function(e,t,n){e.exports=n(376)},145:function(e,t,n){},146:function(e,t,n){},184:function(e,t){},186:function(e,t){},213:function(e,t){},376:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),i=n(134),o=n.n(i),c=(n(145),n(31)),s=n(46),u=n(8),l=n.n(u),g=n(45),d=(n(146),n(72)),h=n(9),m=n(137),p=n.n(m),f=n(138),b=n.n(f),x=n(139),v=n.n(x),w=function(e,t){var n=1/0,r=e;return t.forEach((function(t){var a=v.a.get(e,t);a<n&&(n=a,r=t)})),r},_=function(e,t){for(var n=[],r=e;r<=t;r+=1)n.push(r);return n},j=function(e,t){return Math.round(e*t)},k=function(e,t){for(var n=e.charCodeAt(0),r=t.charCodeAt(0),a=[],i=n;i<=r;i+=1)a.push(String.fromCharCode(i));return a},y=k("A","Z").join(""),E=k("a","z").join(""),O="".concat(E).concat(y),C=_(0,9).join(""),W=_(1,8).join(""),z="".concat(C,":-"),A="".concat(O).concat(C,":-_."),P=["caso-pyro01","stin_wz","ZouGui28","francois24540","DGregson97","nessanumen","AlexKenshin_33","CrazyLittleJazzy","mmartin_m","Dr N. Tropy","Kity_Panda","Jakubeq1_","Assistant de laboratoire","B\xe9b\xe9 N. Tropy","Faux Crash","giomastik","MarioAlfie123","kimmyy043","Mav15151515","Axe34070","Stew"],S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=e.width,a=e.height,i=j(.64,r),o=j(.265,a),c=j(.27,r),s=j(.425,a),u=.73,l=.03,g=.27,d=.1,h=1-u-l,m={top:j(t/8,s),height:j(1/8,s)},p=o+m.top,f=m.height,b=i+j(u,c),x=j(h,c),v=i+j(g,c),w=j(1-h-g-l,c);if("position"===n){var _={left:i,top:p,width:j(d,c),height:f};return _}var k="time"===n,y=k?b:v,E=k?x:w,O={left:y,top:p,width:E,height:f};return O},B=function(){var e=Object(h.createScheduler)(),t=Object(h.createScheduler)(),n=Object(h.createScheduler)(),a=Object(h.createWorker)({logger:function(e){return console.log(e)}}),i=Object(h.createWorker)({logger:function(e){return console.log(e)}}),o=Object(h.createWorker)({logger:function(e){return console.log(e)}}),u=Object(h.createWorker)({logger:function(e){return console.log(e)}}),m=Object(h.createWorker)({logger:function(e){return console.log(e)}}),f=Object(h.createWorker)({logger:function(e){return console.log(e)}});e.addWorker(a),e.addWorker(i),t.addWorker(o),t.addWorker(u),n.addWorker(m),n.addWorker(f);var x=function(){var e=Object(g.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G(!0),L(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var r=Object(g.a)(l.a.mark((function r(){var c,d,h,x,v,j,k,y,O,C,B,I,J,G,M,N,D,K;return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(R){r.next=2;break}return r.abrupt("return");case 2:return L(!0),(c=document.getElementById("img-show"))&&(c.innerHTML=""),E("Loading engine"),r.next=8,a.load();case 8:return r.next=10,i.load();case 10:return r.next=12,o.load();case 12:return r.next=14,u.load();case 14:return r.next=16,m.load();case 16:return r.next=18,f.load();case 18:return E("Loading language"),r.next=21,a.loadLanguage("eng");case 21:return r.next=23,i.loadLanguage("eng");case 23:return r.next=25,o.loadLanguage("eng");case 25:return r.next=27,u.loadLanguage("eng");case 27:return r.next=29,m.loadLanguage("eng");case 29:return r.next=31,f.loadLanguage("eng");case 31:return E("Initializing engine"),r.next=34,a.initialize("eng");case 34:return r.next=36,i.initialize("eng");case 36:return r.next=38,o.initialize("eng");case 38:return r.next=40,u.initialize("eng");case 40:return r.next=42,m.initialize("eng");case 42:return r.next=44,f.initialize("eng");case 44:return r.next=46,a.setParameters({tessedit_char_whitelist:z,tessedit_pageseg_mode:"7"});case 46:return r.next=48,i.setParameters({tessedit_char_whitelist:z,tessedit_pageseg_mode:"7"});case 48:return r.next=50,o.setParameters({tessedit_char_whitelist:A,tessedit_pageseg_mode:"7"});case 50:return r.next=52,u.setParameters({tessedit_char_whitelist:A,tessedit_pageseg_mode:"7"});case 52:return r.next=54,m.setParameters({tessedit_char_whitelist:W,tessedit_pageseg_mode:"7"});case 54:return r.next=56,f.setParameters({tessedit_char_whitelist:W,tessedit_pageseg_mode:"7"});case 56:return d=_(0,7),h=function(){var r=Object(g.a)(l.a.mark((function r(a,i,o,c){var s,u,g,d,h,m,f,b,x,v;return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=j.clone(),u=null,u="time"===i?e:"pseudo"===i?t:n,g=S(o,a,i),d=s.crop(g.left,g.top,g.width,g.height),h={count:2,type:"image/jpeg"},r.next=8,d.getBufferAsync("image/jpeg");case 8:return m=r.sent,r.next=11,p()(m,h).then((function(e){return console.log("\ud83d\ude80 ~ rgb ~ colors",a,e),[e[0].rgb(),e[1].rgb()]}));case 11:return f=r.sent,b=f[0][0]<f[1][0]&&f[0][1]<f[1][1]&&f[0][2]<f[1][2],(x=b?d.invert():d).getBase64("image/jpeg",(function(e,t){var n=document.createElement("img");n.setAttribute("src",t);var r=document.getElementById("img-show");r&&r.appendChild(n)})),r.next=17,x.getBufferAsync("image/jpeg");case 17:return v=r.sent,r.abrupt("return",u.addJob("recognize",v));case 19:case"end":return r.stop()}}),r)})));return function(e,t,n,a){return r.apply(this,arguments)}}(),x="https://raw.githubusercontent.com/sebranly/ctr-ocr/main/src/img/input/IMG".concat(T,".JPG"),E("Reading the image"),r.next=62,b.a.read(x);case 62:return v=r.sent,E("Rotating the image"),(j=v.rotate(-6.2).grayscale()).getBase64("image/jpeg",(function(e,t){var n=document.createElement("img");n.setAttribute("src",t);var r=document.getElementById("img-show");r&&r.appendChild(n)})),k=j.bitmap.width,y=j.bitmap.height,O={width:k,height:y},console.log("info.width",O.width,"info.height",O.height),C=d.map((function(e){return h(e,"position",O,j)})),B=d.map((function(e){return h(e,"pseudo",O,j)})),I=d.map((function(e){return h(e,"time",O,j)})),E("Starting text recognition"),r.next=76,Promise.all([].concat(Object(s.a)(C),Object(s.a)(B),Object(s.a)(I)));case 76:J=r.sent,G=J.map((function(e){return e.data.text.replace(/\n/g,"").replace(/ /g,"")})),M=G.slice(0,8),console.log("\ud83d\ude80 ~ file: App.tsx ~ line 269 ~ doOCR ~ resultsPositions",M),N=G.slice(8,16),D=G.slice(16),K=[],d.forEach((function(e){var t=N[e],n={g:t,position:M[e],player:w(t,P),time:D[e]};K.push(n)})),E(JSON.stringify(K)),L(!1);case 86:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),j=r.useState("Pick an image"),k=Object(c.a)(j,2),y=k[0],E=k[1],O=r.useState(!0),C=Object(c.a)(O,2),B=C[0],L=C[1],I=r.useState(!1),J=Object(c.a)(I,2),R=J[0],G=J[1],M=r.useState(1),N=Object(c.a)(M,2),T=N[0],D=N[1];r.useEffect((function(){v()}),[T]),r.useEffect((function(){x()}),[]);var K="https://raw.githubusercontent.com/sebranly/ctr-ocr/main/src/img/input/IMG".concat(T,".JPG"),Z=_(1,5);return r.createElement(d.b,null,r.createElement(d.a,null,r.createElement("title",null,"CTR OCR"),r.createElement("link",{rel:"canonical",href:"https://sebranly.github.io/ctr-ocr"})),r.createElement("div",{className:"main"},r.createElement("h1",{className:"white"},"CTR OCR"),r.createElement("select",{disabled:B,onChange:function(e){D(Number(e.target.value))}},Z.map((function(e){return r.createElement("option",{key:e,label:e.toString(),value:e},"Image ",e)}))),r.createElement("img",{alt:"Example ".concat(T),src:K}),r.createElement("div",null,y),r.createElement("div",{id:"img-show"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[140,1,2]]]);
//# sourceMappingURL=main.70f1c4cc.chunk.js.map