(this["webpackJsonpctr-ocr"]=this["webpackJsonpctr-ocr"]||[]).push([[0],{146:function(e,t,n){e.exports=n(386)},151:function(e,t,n){},152:function(e,t,n){},190:function(e,t){},192:function(e,t){},219:function(e,t){},386:function(e,t,n){"use strict";n.r(t);var a,r,c=n(0),l=n.n(c),o=n(139),i=n.n(o),s=(n(151),n(19)),u=n(7),m=n(8),h=n.n(m),d=n(46),f=(n(152),n(74)),g=n(76);!function(e){e.Position="position",e.Time="time",e.Username="username",e.All="all"}(a||(a={})),function(e){e.NotStarted="not_started",e.Started="started",e.Done="done"}(r||(r={}));var p=n(142),b=n.n(p),v=n(77),E=n.n(v),y=n(145),x=n.n(y),w=n(143),N=n.n(w),k=n(47),j=n(45),O=n(144),P=n.n(O),C=function(e){return e&&"png"===e.toLowerCase()?K:$},S=function(e){return e&&0!==e.length?e.filter((function(e){return!!e})).sort().join(ee):""},R=function(e){return e?e.split(ee).filter((function(e){return!!e})):[]},_=function(e,t,n){if(!e)return[];var a=R(e);if(!n||!t)return a;var r=R(t);return[].concat(Object(s.a)(a),Object(s.a)(r))},A=function(e,t){var n=t.filter((function(e){return!!e})),a=1/0,r=e;return n.forEach((function(t){var n=P.a.get(e,t);n<a&&(a=n,r=t)})),r},G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=e.width,c=e.height,l=J(.64,r),o=J(.265,c),i=J(.27,r),s=J(.425,c);if(n===a.All){var u=t/z,m={height:J(u,s),left:l,top:o,width:i};return m}var h=.73,d=.03,f=.27,g=.1,p=1-h-d,b={top:J(t/8,s),height:J(1/8,s)},v=o+b.top,E=b.height;if(n===a.Position){var y={height:E,left:l,top:v,width:J(g,i)};return y}var x=l+J(h,i),w=J(p,i),N=l+J(f,i),k=J(1-p-f-d,i),j=n===a.Time,O=j?x:N,P=j?w:k,C={height:E,left:O,top:v,width:P};return C},T=function(e,t){for(var n=[],a=e;a<=t;a+=1)n.push(a);return n},U=function(e){var t=a.Position,n=a.Time,r=a.Username;switch(e){case t:return{tessedit_char_whitelist:X,tessedit_pageseg_mode:Q};case r:return{tessedit_char_whitelist:Z,tessedit_pageseg_mode:V};case n:default:return{tessedit_char_whitelist:Y,tessedit_pageseg_mode:V}}},J=function(e,t){return Math.floor(e*t)},M=function(e,t){for(var n=e.charCodeAt(0),a=t.charCodeAt(0),r=[],c=n;c<=a;c+=1)r.push(String.fromCharCode(c));return r},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];F&&(t?console.timeEnd(e):console.time(e))},z=8,B="https://".concat("sebranly",".github.io"),F=!1,I="".concat(B,"/").concat("ctr-ocr"),H=M("A","Z").join(""),W=M("a","z").join(""),D="".concat(W).concat(H),q=T(0,9).join(""),X=T(1,z).join(""),Y="".concat(q,":-"),Z="".concat(D).concat(q,":-_. "),$="image/jpeg",K="image/png",Q="10",V="7",ee="\n",te="".concat(B,"/json/ctrocr/players.json"),ne="https://raw.githubusercontent.com/".concat("sebranly","/").concat("ctr-ocr","/main/src/img/examples/"),ae=["PS5"],re=function(){var e=function(e){var t=function(e){var t="".concat(e);return c.createElement("option",{key:e,label:t,value:e},t)};return c.createElement("tbody",null,ke[e].map((function(n,a){var r,l,o=n.position,i=n.username,s="".concat(o,"-").concat(i);return c.createElement("tr",{key:s},c.createElement("td",null,o),Be&&c.createElement("td",null,(r=i,(l=Ce)&&R(l).includes(r)?"\ud83d\udc64":"\ud83e\udd16")),c.createElement("td",null,c.createElement("select",{disabled:pe,onChange:qe(e,a),value:i},function(){var e=R(Ce).sort();if(!Be)return e.map(t);var n=R(Ae).sort();return c.createElement(c.Fragment,null,c.createElement("optgroup",{key:"human",label:"Human"},e.map(t)),c.createElement("optgroup",{key:"cpus",label:"CPUs"},n.map(t)))}())))})))},t=function(t){var n="Race ".concat(t+1),a=function(e){var t={correct:!1,errMsg:""};return e.some((function(e){return!e}))?(t.errMsg="At least one username is missing",t):Object(j.uniq)(e).length!==e.length?(t.errMsg="At least one username is duplicated",t):(t.correct=!0,t)}(ke[t].map((function(e){return e.username})));return c.createElement("div",{key:t},c.createElement("h3",null,n),function(e){if(!re||re.length<=e)return null;var t=k.isMobile?"img-show max-width-100":"img-show max-width-45";return c.createElement("img",{alt:"Cropped Results",className:t,src:re[e]})}(t),c.createElement("div",{className:"flex-container results"},function(t){return c.createElement("table",{className:"flex-1"},c.createElement("thead",null,c.createElement("tr",null,c.createElement("th",null,"Position"),Be&&c.createElement("th",null,"Type"),c.createElement("th",null,"Name"))),e(t))}(t)),!a.correct&&c.createElement("div",{className:"red"},a.errMsg))},n=function(){if(!Je||0===Object.keys(Je).length)return c.createElement("div",{className:"text-center mb"},"Loading CPUs...");var e=Object.keys(Je),t=He?"Automatically activated bots because ".concat(Ie," human player(s) was/were filled out of a total of ").concat(ie," players"):"Check this if there were bots during the race";return c.createElement(c.Fragment,null,c.createElement("div",{className:"text-center mb"},c.createElement("input",{name:"includeCpuPlayers",type:"checkbox",checked:Be,onChange:Xe,disabled:He}),c.createElement("div",{className:"ml inline"},t)),Be&&c.createElement(c.Fragment,null,c.createElement("div",{className:"text-center mb"},"Bots are automatically determined based on the language and cannot be edited"),c.createElement("div",{className:"inline mr"},"Language in images"),c.createElement("select",{disabled:pe,onChange:De,value:he},e.map((function(e){var t="".concat(e);return c.createElement("option",{key:e,label:t,value:e},t)}))),c.createElement("textarea",{className:"textarea-".concat(Ze),disabled:!0,placeholder:"Loading CPUs...",rows:z,value:Ae})))},l=function(){var e=Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xe(!0),be(!1),fetch(te).then((function(e){return e.json()})).then((function(e){Me(e),Ge(S(e.en))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(d.a)(h.a.mark((function e(){var t,n,c,l,o,i,s,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ye){e.next=2;break}return e.abrupt("return");case 2:return be(!0),O(r.Started),B("Initialization..."),je([]),ce([]),t=Object(g.createScheduler)(),n=Object(g.createWorker)({}),t.addWorker(n),e.next=12,n.load();case 12:return e.next=14,n.loadLanguage("eng");case 14:return e.next=16,n.initialize("eng");case 16:return c=U(a.Username),e.next=19,n.setParameters(c);case 19:l=T(0,ie-1),o=function(){var e=Object(d.a)(h.a.mark((function e(n,a,r,c){var l,o,i,s,u,m,d,f,g,p,v;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=t,o=G(r,n,a),i=r.extension,s=C(i),u=c.crop(o.left,o.top,o.width,o.height),m={count:2,type:s},e.next=8,u.getBufferAsync(s);case 8:return d=e.sent,e.next=11,b()(d,m).then((function(e){return[e[0].rgb(),e[1].rgb()]}));case 11:return f=e.sent,g=f[0][0]<f[1][0]&&f[0][1]<f[1][1]&&f[0][2]<f[1][2],p=g?u.invert():u,e.next=16,p.getBufferAsync(s);case 16:return v=e.sent,e.abrupt("return",l.addJob("recognize",v));case 18:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),i=[],s=[],u=0;case 24:if(!(u<Z.length)){e.next=36;break}return e.prev=25,e.delegateYield(h.a.mark((function e(){var t,n,r,c,m,d,f,g,p,b,v,y,x,w,N,k,j,O;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="Image ".concat(u+1," out of ").concat(Z.length,"..."),B(t),L("imgRead"),e.next=5,E.a.read(Z[u]);case 5:return n=e.sent,L("imgRead",!0),r=n.bitmap.height,(c=r>1e3)&&L("imgResize"),m=c?n.resize(E.a.AUTO,1e3):n,c&&L("imgResize",!0),L("imgRotate"),d=m.rotate(-6.2),L("imgRotate",!0),L("imgRest"),f=d.bitmap.height,g=d.bitmap.width,p=d.getExtension(),v=G(b={height:f,extension:p,width:g},ie,a.All),y=d.clone(),y.crop(v.left,v.top,v.width,v.height).getBase64($,(function(e,t){s.push(t)})),x=d.grayscale(),L("imgRest",!0),L("promisesCreation"),w=l.map((function(e){return o(e,a.Username,b,x.clone())})),L("promisesCreation",!0),L("promisesResolve"),e.next=32,Promise.all(w);case 32:N=e.sent,L("promisesResolve",!0),k=N.map((function(e){return e.data.text.replace(/\n/g,"").replace(/ /g,"")})),j=[],O=_(Ce,Ae,Be),l.forEach((function(e){var t=k[e],n={username:A(t,O),position:e+1};j.push(n)})),i.push(j);case 39:case"end":return e.stop()}}),e)}))(),"t0",27);case 27:e.next=33;break;case 29:e.prev=29,e.t1=e.catch(25),m=e.t1,F&&console.log(m),be(!1);case 33:u++,e.next=24;break;case 36:return je(i),ce(s),O(r.Done),B(""),be(!1),e.next=43,t.terminate();case 43:case"end":return e.stop()}var m}),e,null,[[25,29]])})));return function(){return e.apply(this,arguments)}}(),i=x()(),m=i.width,p=i.height,v=c.useState(r.NotStarted),y=Object(u.a)(v,2),w=y[0],O=y[1],P=c.useState(""),J=Object(u.a)(P,2),M=J[0],B=J[1],H=c.useState([]),W=Object(u.a)(H,2),D=W[0],q=W[1],X=c.useState([]),Y=Object(u.a)(X,2),Z=Y[0],Q=Y[1],V=c.useState([]),ee=Object(u.a)(V,2),re=ee[0],ce=ee[1],le=c.useState(z),oe=Object(u.a)(le,2),ie=oe[0],se=oe[1],ue=c.useState("en"),me=Object(u.a)(ue,2),he=me[0],de=me[1],fe=c.useState(!0),ge=Object(u.a)(fe,2),pe=ge[0],be=ge[1],ve=c.useState(!1),Ee=Object(u.a)(ve,2),ye=Ee[0],xe=Ee[1],we=c.useState([]),Ne=Object(u.a)(we,2),ke=Ne[0],je=Ne[1],Oe=c.useState(""),Pe=Object(u.a)(Oe,2),Ce=Pe[0],Se=Pe[1],Re=c.useState("Loading CPUs..."),_e=Object(u.a)(Re,2),Ae=_e[0],Ge=_e[1],Te=c.useState({}),Ue=Object(u.a)(Te,2),Je=Ue[0],Me=Ue[1],Le=c.useState(!1),ze=Object(u.a)(Le,2),Be=ze[0],Fe=ze[1],Ie=R(Ce).length,He=Ie<ie;c.useEffect((function(){l()}),[]),c.useEffect((function(){if(!(D.length<1)){var e=[];Object(j.sortBy)(D,(function(e){return e.name})).forEach((function(t){return e.push(URL.createObjectURL(t))})),Q(e)}}),[D]),c.useEffect((function(){He&&!Be&&Fe(!0)}),[He,Be]);var We=function(e){q(Object(s.a)(e.target.files)),je([])},De=function(e){de(e.target.value),Ge(S(Je[e.target.value]))},qe=function(e,t){return function(n){if(ke&&!(ke.length<e)){var a=Object(s.a)(ke);a[e][t].username=n.target.value,je(a)}}},Xe=function(e){Fe(e.target.checked)},Ye=T(2,z),Ze=k.isMobile?"mobile":"desktop",$e=pe?"bg-grey":"bg-white";return c.createElement(f.b,null,c.createElement(f.a,null,c.createElement("title",null,"Crash Team Results"),c.createElement("link",{rel:"canonical",href:I})),c.createElement("div",{className:"main"},c.createElement("h1",null,"Crash Team Results"),c.createElement("div",{className:"w3-light-grey"}),w===r.Done&&c.createElement(N.a,{width:m,height:p,numberOfPieces:800,recycle:!1}),c.createElement("div",{className:"center main-content-".concat(Ze," ").concat($e)},w!==r.Started?null:c.createElement("div",{className:"progress-bar"},c.createElement("div",{className:"progress-bar-value"}),c.createElement("div",{className:"progress-bar-text"},M)),c.createElement("h2",null,"Players"),c.createElement("h3",null,"Number of players"),c.createElement("div",{className:"text-center mb"},"This includes CPUs if any"),c.createElement("select",{disabled:pe,onChange:function(e){se(Number(e.target.value))},value:ie},Ye.map((function(e){var t="".concat(e," players");return c.createElement("option",{key:e,label:t,value:e},t)}))),c.createElement("h3",null,"Human Players"),c.createElement("div",{className:"text-center mb"},"Type all human players present in the races. Type one username per line."),c.createElement("textarea",{className:"textarea-".concat(Ze),disabled:pe,placeholder:"Hy\xe8ne_JurassX\nAlexiz\nColonel_Hay\nTATANE",rows:ie,value:Ce,onChange:function(e){Se(e.currentTarget.value)}}),function(){if(0===Ie)return null;var e="".concat(ne,"IMG1.JPG"),a="".concat(ne,"IMG1.PNG");return c.createElement(c.Fragment,null,c.createElement(c.Fragment,null,c.createElement("h3",null,"CPUs"),n()),c.createElement("h2",null,"Images"),c.createElement("div",{className:"text-center mb"},c.createElement("div",{className:"ml block mb bold"},"Screenshots will be ordered alphabetically by name"),c.createElement("div",{className:"ml block mb italic"},"Only screenshots from the following platforms have been tested so far: ".concat(ae)),c.createElement("div",{className:"ml block mb"},"Select screenshots in JPG/JPEG (recommended) or PNG format, taken right when Returning to Lobby was around 14 seconds"),c.createElement("div",{className:"ml block mb"},"JPG/JPEG is recommended because it provides the same quality of results and is lighter than PNG"),c.createElement("div",{className:"ml block mb"},c.createElement("a",{href:e,rel:"noopener noreferrer",title:"Example of valid JPEG screenshot",target:"_blank"},"Example of a valid JPG/JPEG screenshot")),c.createElement("div",{className:"ml block mb"},c.createElement("a",{href:a,rel:"noopener noreferrer",title:"Example of valid PNG screenshot",target:"_blank"},"Example of a valid PNG screenshot")),c.createElement("input",{className:"inline mt",disabled:pe,type:"file",multiple:!0,accept:[$,K].join(", "),onChange:We}),c.createElement("input",{className:"inline-block ml",type:"button",value:"Start recognition",disabled:pe||!Z||0===Z.length,onClick:o})),k.isMobile?Z.map((function(e,t){return c.createElement("img",{alt:"tbd",className:"img-full max-width-100 block",key:"".concat(e,"-").concat(t),src:e})})):c.createElement("div",{className:"flex-container center"},Z.map((function(e,t){return c.createElement("img",{alt:"tbd",className:"img-full max-width-45 flex-1",key:"".concat(e,"-").concat(t),src:e})}))),ke&&0!==ke.length?c.createElement(c.Fragment,null,c.createElement("div",{className:"center"},c.createElement("h2",null,"Results"),ke.map((function(e,n){return t(n)})))):null)}()),c.createElement("div",{className:"mt2 text-center"},"v".concat("1.0.1"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(re,null),","),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[146,1,2]]]);
//# sourceMappingURL=main.9d28a7a3.chunk.js.map