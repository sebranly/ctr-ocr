(this["webpackJsonpctr-ocr"]=this["webpackJsonpctr-ocr"]||[]).push([[0],{140:function(e,t,n){e.exports=n(376)},145:function(e,t,n){},146:function(e,t,n){},184:function(e,t){},186:function(e,t){},213:function(e,t){},376:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),i=n(134),o=n.n(i),c=(n(145),n(31)),s=n(46),g=n(8),u=n.n(g),l=n(45),d=(n(146),n(72)),m=n(9),h=n(137),p=n.n(h),f=n(138),b=n.n(f),x=n(139),v=n.n(x),w=function(e,t){var n=1/0,r=e;return t.forEach((function(t){var a=v.a.get(e,t);a<n&&(n=a,r=t)})),r},_=function(e,t){for(var n=[],r=e;r<=t;r+=1)n.push(r);return n},j=function(e,t){return Math.round(e*t)},k=function(e,t){for(var n=e.charCodeAt(0),r=t.charCodeAt(0),a=[],i=n;i<=r;i+=1)a.push(String.fromCharCode(i));return a},y=k("A","Z").join(""),E=k("a","z").join(""),O="".concat(E).concat(y),L=_(0,9).join(""),S=_(1,8).join(""),z="".concat(L,":-"),C="".concat(O).concat(L,":-_."),I=["caso-pyro01","stin_wz","ZouGui28","francois24540","DGregson97","nessanumen","AlexKenshin_33","CrazyLittleJazzy","mmartin_m","Dr N. Tropy","Kity_Panda","Jakubeq1_","Assistant de laboratoire","B\xe9b\xe9 N. Tropy","Faux Crash","giomastik","MarioAlfie123","kimmyy043","Mav15151515","Axe34070","Stew"],W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=e.width,a=e.height,i=j(.64,r),o=j(.265,a),c=j(.27,r),s=j(.425,a),g=.73,u=.03,l=.27,d=.1,m=1-g-u,h={top:j(t/8,s),height:j(1/8,s)},p=o+h.top,f=h.height,b=i+j(g,c),x=j(m,c),v=i+j(l,c),w=j(1-m-l-u,c);if("position"===n){var _={left:i,top:p,width:j(d,c),height:f};return _}var k="time"===n,y=k?b:v,E=k?x:w,O={left:y,top:p,width:E,height:f};return O},P=function(){var e=Object(m.createScheduler)(),t=Object(m.createScheduler)(),n=Object(m.createScheduler)(),a=Object(m.createWorker)({logger:function(e){return console.log(e)}}),i=Object(m.createWorker)({logger:function(e){return console.log(e)}}),o=Object(m.createWorker)({logger:function(e){return console.log(e)}}),g=Object(m.createWorker)({logger:function(e){return console.log(e)}}),h=Object(m.createWorker)({logger:function(e){return console.log(e)}}),f=Object(m.createWorker)({logger:function(e){return console.log(e)}});e.addWorker(a),e.addWorker(i),t.addWorker(o),t.addWorker(g),n.addWorker(h),n.addWorker(f);var x=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G(!0),A(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var r=Object(l.a)(u.a.mark((function r(){var c,d,m,x,v,j,k,y,O,L,P,B,J,G,M,N,D,K;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(R){r.next=2;break}return r.abrupt("return");case 2:return A(!0),(c=document.getElementById("img-show"))&&(c.innerHTML=""),E("Loading engines"),E("Loading engine 1"),r.next=9,a.load();case 9:return E("Loading engine 2"),r.next=12,i.load();case 12:return E("Loading engine 3"),r.next=15,o.load();case 15:return E("Loading engine 4"),r.next=18,g.load();case 18:return E("Loading engine 5"),r.next=21,h.load();case 21:return E("Loading engine 6"),r.next=24,f.load();case 24:return E("Loading languages"),E("Loading language 1"),r.next=28,a.loadLanguage("eng");case 28:return E("Loading language 2"),r.next=31,i.loadLanguage("eng");case 31:return E("Loading language 3"),r.next=34,o.loadLanguage("eng");case 34:return E("Loading language 4"),r.next=37,g.loadLanguage("eng");case 37:return E("Loading language 5"),r.next=40,h.loadLanguage("eng");case 40:return E("Loading language 6"),r.next=43,f.loadLanguage("eng");case 43:return E("Initializing engines"),E("Initializing engine 1"),r.next=47,a.initialize("eng");case 47:return E("Initializing engine 2"),r.next=50,i.initialize("eng");case 50:return E("Initializing engine 3"),r.next=53,o.initialize("eng");case 53:return E("Initializing engine 4"),r.next=56,g.initialize("eng");case 56:return E("Initializing engine 5"),r.next=59,h.initialize("eng");case 59:return E("Initializing engine 6"),r.next=62,f.initialize("eng");case 62:return E("Setting parameters"),E("Setting parameter 1"),r.next=66,a.setParameters({tessedit_char_whitelist:z,tessedit_pageseg_mode:"7"});case 66:return E("Setting parameter 2"),r.next=69,i.setParameters({tessedit_char_whitelist:z,tessedit_pageseg_mode:"7"});case 69:return E("Setting parameter 3"),r.next=72,o.setParameters({tessedit_char_whitelist:C,tessedit_pageseg_mode:"7"});case 72:return E("Setting parameter 4"),r.next=75,g.setParameters({tessedit_char_whitelist:C,tessedit_pageseg_mode:"7"});case 75:return E("Setting parameter 5"),r.next=78,h.setParameters({tessedit_char_whitelist:S,tessedit_pageseg_mode:"7"});case 78:return E("Setting parameter 6"),r.next=81,f.setParameters({tessedit_char_whitelist:S,tessedit_pageseg_mode:"7"});case 81:return d=_(0,7),m=function(){var r=Object(l.a)(u.a.mark((function r(a,i,o,c){var s,g,l,d,m,h,f,b,x,w;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=v.clone(),g=null,g="time"===i?e:"pseudo"===i?t:n,l=W(o,a,i),d=s.crop(l.left,l.top,l.width,l.height),m={count:2,type:"image/jpeg"},r.next=8,d.getBufferAsync("image/jpeg");case 8:return h=r.sent,r.next=11,p()(h,m).then((function(e){return console.log("\ud83d\ude80 ~ rgb ~ colors",a,e),[e[0].rgb(),e[1].rgb()]}));case 11:return f=r.sent,b=f[0][0]<f[1][0]&&f[0][1]<f[1][1]&&f[0][2]<f[1][2],(x=b?d.invert():d).getBase64("image/jpeg",(function(e,t){var n=document.createElement("img");n.setAttribute("src",t);var r=document.getElementById("img-show");r&&r.appendChild(n)})),r.next=17,x.getBufferAsync("image/jpeg");case 17:return w=r.sent,r.abrupt("return",g.addJob("recognize",w));case 19:case"end":return r.stop()}}),r)})));return function(e,t,n,a){return r.apply(this,arguments)}}(),x="https://raw.githubusercontent.com/sebranly/ctr-ocr/main/src/img/input/IMG".concat(T,".JPG"),E("Reading the image"),r.prev=85,r.next=88,b.a.read(x);case 88:return j=r.sent,E("Rotating the image"),(v=j.rotate(-6.2).grayscale()).getBase64("image/jpeg",(function(e,t){var n=document.createElement("img");n.setAttribute("src",t);var r=document.getElementById("img-show");r&&r.appendChild(n)})),k=v.bitmap.width,y=v.bitmap.height,O={width:k,height:y},console.log("info.width",O.width,"info.height",O.height),L=d.map((function(e){return m(e,"position",O,v)})),P=d.map((function(e){return m(e,"pseudo",O,v)})),B=d.map((function(e){return m(e,"time",O,v)})),E("Starting text recognition"),r.next=102,Promise.all([].concat(Object(s.a)(L),Object(s.a)(P),Object(s.a)(B)));case 102:J=r.sent,G=J.map((function(e){return e.data.text.replace(/\n/g,"").replace(/ /g,"")})),M=G.slice(0,8),console.log("\ud83d\ude80 ~ file: App.tsx ~ line 269 ~ doOCR ~ resultsPositions",M),N=G.slice(8,16),D=G.slice(16),K=[],d.forEach((function(e){var t=N[e],n={g:t,position:M[e],player:w(t,I),time:D[e]};K.push(n)})),E(JSON.stringify(K)),A(!1),r.next=118;break;case 114:r.prev=114,r.t0=r.catch(85),E("Unable to open image ".concat(r.t0.toString(),". Please restart.")),A(!1);case 118:case"end":return r.stop()}}),r,null,[[85,114]])})));return function(){return r.apply(this,arguments)}}(),j=r.useState("Pick an image"),k=Object(c.a)(j,2),y=k[0],E=k[1],O=r.useState(!0),L=Object(c.a)(O,2),P=L[0],A=L[1],B=r.useState(!1),J=Object(c.a)(B,2),R=J[0],G=J[1],M=r.useState(1),N=Object(c.a)(M,2),T=N[0],D=N[1];r.useEffect((function(){v()}),[T]),r.useEffect((function(){x()}),[]);var K="https://raw.githubusercontent.com/sebranly/ctr-ocr/main/src/img/input/IMG".concat(T,".JPG"),Z=_(1,5);return r.createElement(d.b,null,r.createElement(d.a,null,r.createElement("title",null,"CTR OCR"),r.createElement("link",{rel:"canonical",href:"https://sebranly.github.io/ctr-ocr"})),r.createElement("div",{className:"main"},r.createElement("h1",{className:"white"},"CTR OCR"),r.createElement("select",{disabled:P,onChange:function(e){D(Number(e.target.value))}},Z.map((function(e){return r.createElement("option",{key:e,label:e.toString(),value:e},"Image ",e)}))),r.createElement("img",{alt:"Example ".concat(T),src:K}),r.createElement("div",null,y),r.createElement("div",{id:"img-show"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[140,1,2]]]);
//# sourceMappingURL=main.70c6c8f0.chunk.js.map